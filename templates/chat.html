{% extends "base.html" %}
{% block content %}

<section class="chat-wrapper" data-api-base-url="{{ api_base_url }}">
  <div class="chat-layout">

    <aside class="chat-sidebar">
      <a href="/" class="sidebar-logo-link">
        <img src="/static/img/logo.png" alt="Hivemind Logo" class="sidebar-logo-img">
        <span class="sidebar-logo-text">Hivemind</span>
      </a>

      <div class="sidebar-header">
        <button class="btn-new-chat" id="new-chat-btn">
          <span>+</span> New chat
        </button>
      </div>

      <div class="conversation-list" id="conversation-list">
      </div>
    </aside>

    <div class="chat-main">
      <div class="chat-empty-state" id="chat-empty-state">
        <h2 class="empty-prompt">What's on your mind today?</h2>
      </div>

      <div class="chat-container" id="chat-container" style="display: none;">
        <div class="chat-messages" id="messages"></div>
      </div>

      <div class="chat-input-wrapper">
        <form class="chat-input" id="chat-form" enctype="multipart/form-data">
          <div id="file-preview-container" class="file-preview-container"></div>
          <div class="input-container">
            <label for="file-input" class="file-upload-icon" title="Upload files">
              <span>ğŸ“</span>
              <input type="file" id="file-input" multiple accept=".pdf,.png,.jpg,.jpeg,.gif,.csv,.txt,.md,.json,.xlsx" style="display: none;" />
            </label>
            <input id="chat-text" type="text" placeholder="Ask anything (with optional files)" autocomplete="off" />
            <button type="submit" class="send-button">ğŸ</button>
          </div>
        </form>
      </div>
    </div>

  </div>
</section>

<div class="context-menu" id="context-menu">
  <button class="menu-item" data-action="rename"><span>âœï¸</span> Rename</button>
  <button class="menu-item" data-action="share"><span>ğŸ”—</span> Share</button>
  <button class="menu-item" data-action="delete"><span>ğŸ—‘ï¸</span> Delete</button>
</div>

<div class="modal-overlay" id="rename-modal">
  <div class="modal">
    <h3>Rename Conversation</h3>
    <input type="text" id="rename-input" placeholder="Enter new name..." />
    <div class="modal-actions">
      <button class="btn-cancel" id="rename-cancel">Cancel</button>
      <button class="btn-confirm" id="rename-confirm">Save</button>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Layout fixes
    const app = document.getElementById('app');
    if (app) {
      app.style.padding = '0';
      app.style.margin = '0';
      app.style.height = '100vh';
      app.style.overflow = 'hidden';
    }
    document.body.style.overflow = 'hidden';
  });
</script>
<script src="/static/js/chat.js"></script>
{% endblock %}